# TRD (기술 요구사항 정의서)

> 새봄컨설팅 - 해외 수출 인증·허가 원스톱 대행 서비스

---

## MVP 캡슐

| #   | 항목                 | 내용                                                                                   |
| --- | -------------------- | -------------------------------------------------------------------------------------- |
| 1   | 목표                 | 처음 수출하는 사업자에게 인증·허가 진입장벽을 낮추고, 합리적 비용으로 전문 서비스 제공 |
| 2   | 페르소나             | 처음 식품/화장품 수출을 시도하는 중소기업 담당자                                       |
| 3   | 핵심 기능            | FEAT-1: 랜딩 페이지 (신뢰 구축), FEAT-2: 무료 라벨링 서비스 (리드 수집)                |
| 4   | 성공 지표 (노스스타) | 월간 정식 의뢰 전환 수                                                                 |
| 5   | 입력 지표            | 무료 라벨링 서비스 사용 수, 견적 문의 수                                               |
| 6   | 비기능 요구          | 페이지 로딩 < 3초, Lighthouse 점수 90+                                                 |
| 7   | Out-of-scope         | 결제 시스템, 고객 포털, 실시간 채팅                                                    |
| 8   | Top 리스크           | 무료 서비스만 사용하고 이탈                                                            |
| 9   | 완화/실험            | 이메일 리드 수집 후 후속 마케팅                                                        |
| 10  | 다음 단계            | Astro 프로젝트 셋업 및 랜딩 페이지 개발                                                |

---

## 1. 시스템 아키텍처

### 1.1 고수준 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                         Vercel Edge                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐       │
│  │   Astro     │     │   Astro     │     │   Resend    │       │
│  │   Static    │     │   API       │────▶│   Email     │       │
│  │   Pages     │     │   Routes    │     │   Service   │       │
│  └─────────────┘     └─────────────┘     └─────────────┘       │
│        │                   │                                    │
│        └───────────────────┴─────▶ newbom@newbom.co.kr         │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                      React Islands                               │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │              Global Label AI (라벨링 서비스)              │   │
│  │  - Step 1: 프로젝트 설정 + 이메일                        │   │
│  │  - Step 2: 원재료 분석                                   │   │
│  │  - Step 3: 영양 성분 변환                                │   │
│  │  - Step 4: 최종 라벨 출력 + CTA                          │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 1.2 컴포넌트 설명

| 컴포넌트         | 역할                    | 왜 이 선택?                              |
| ---------------- | ----------------------- | ---------------------------------------- |
| Astro Static     | 랜딩 페이지 정적 렌더링 | SEO 최적화, 빠른 로딩                    |
| React Islands    | 라벨링 서비스 동적 UI   | 복잡한 상태 관리, 기존 프로토타입 재활용 |
| Astro API Routes | 이메일 발송 API         | 서버리스, Vercel 통합                    |
| Resend           | 이메일 발송             | 개발자 친화적, 간단한 API                |

---

## 2. 권장 기술 스택

### 2.1 프론트엔드

| 항목        | 선택             | 이유                                     | 벤더 락인 리스크 |
| ----------- | ---------------- | ---------------------------------------- | ---------------- |
| 프레임워크  | Astro 4.x        | 정적 사이트 최적화, Islands Architecture | 낮음             |
| UI 아일랜드 | React 18         | 기존 프로토타입 호환, 생태계             | 낮음             |
| 언어        | TypeScript       | 타입 안전성, 유지보수                    | -                |
| 스타일링    | Tailwind CSS 3.x | 프로토타입에서 이미 사용, 빠른 개발      | 낮음             |
| 아이콘      | Lucide React     | 경량, 트리 셰이킹                        | 낮음             |

### 2.2 백엔드 (서버리스)

| 항목        | 선택             | 이유                          | 벤더 락인 리스크 |
| ----------- | ---------------- | ----------------------------- | ---------------- |
| API         | Astro API Routes | 별도 서버 불필요, Vercel 통합 | 중간             |
| 이메일      | Resend           | 개발자 친화적, 무료 티어 충분 | 낮음             |
| 유효성 검증 | Zod              | TypeScript 네이티브           | 낮음             |

### 2.3 인프라

| 항목     | 선택             | 이유                               |
| -------- | ---------------- | ---------------------------------- |
| 호스팅   | Vercel           | Astro 최적화, Edge 배포, 무료 티어 |
| 도메인   | newbom.co.kr     | 기존 보유 (가정)                   |
| CDN      | Vercel Edge      | 자동 포함                          |
| 모니터링 | Vercel Analytics | 무료, 통합                         |

### 2.4 개발 도구

| 항목          | 선택                | 이유              |
| ------------- | ------------------- | ----------------- |
| 패키지 매니저 | pnpm                | 빠름, 디스크 효율 |
| 린터          | ESLint + Prettier   | 표준              |
| Git 훅        | Husky + lint-staged | 커밋 전 검증      |

---

## 3. 비기능 요구사항

### 3.1 성능

| 항목                           | 요구사항            | 측정 방법  |
| ------------------------------ | ------------------- | ---------- |
| LCP (Largest Contentful Paint) | < 2.5초             | Lighthouse |
| FID (First Input Delay)        | < 100ms             | Lighthouse |
| CLS (Cumulative Layout Shift)  | < 0.1               | Lighthouse |
| Lighthouse 점수                | ≥ 90 (Performance)  | Lighthouse |
| 번들 사이즈                    | < 200KB (초기 로드) | 빌드 분석  |

### 3.2 SEO

| 항목          | 요구사항                          |
| ------------- | --------------------------------- |
| 메타 태그     | title, description, og:image 필수 |
| sitemap.xml   | 자동 생성                         |
| robots.txt    | 검색 허용                         |
| 구조화 데이터 | LocalBusiness, Service 스키마     |
| Canonical URL | 중복 방지                         |

### 3.3 보안

| 항목          | 요구사항              |
| ------------- | --------------------- |
| HTTPS         | 필수 (Vercel 자동)    |
| 이메일 검증   | Zod로 서버 측 검증    |
| Rate Limiting | Vercel Edge 기본 제공 |
| CORS          | Astro 기본 설정       |

### 3.4 접근성

| 항목              | 요구사항               |
| ----------------- | ---------------------- |
| WCAG              | 2.1 AA 준수            |
| 키보드 네비게이션 | 모든 기능 접근 가능    |
| 스크린 리더       | aria-label 적절히 사용 |
| 색상 대비         | 4.5:1 이상             |

---

## 4. 외부 API 연동

### 4.1 이메일 서비스

| 서비스 | 용도                | 필수/선택 | 연동 방식 |
| ------ | ------------------- | --------- | --------- |
| Resend | 리드 알림 메일 발송 | 필수      | REST API  |

**Resend 설정:**

```typescript
// 환경 변수
RESEND_API_KEY=re_xxxxx

// 발송 대상
FROM: noreply@newbom.co.kr (또는 Resend 기본 도메인)
TO: newbom@newbom.co.kr
```

### 4.2 외부 링크

| 서비스        | 용도      | 연동 방식    |
| ------------- | --------- | ------------ |
| 카카오톡 채널 | 상담 연결 | 외부 링크    |
| 이메일        | 견적 문의 | mailto: 링크 |

---

## 5. 접근제어·권한 모델

### 5.1 역할 정의

| 역할   | 설명        | 권한                    |
| ------ | ----------- | ----------------------- |
| 방문자 | 모든 사용자 | 전체 접근 (인증 불필요) |

> 이 프로젝트는 인증/로그인이 없습니다. 모든 기능이 공개입니다.

---

## 6. 데이터 생명주기

### 6.1 원칙

- **최소 수집**: 이메일만 수집
- **명시적 동의**: 이메일 입력 시 마케팅 동의 문구 표시
- **즉시 전송**: 데이터베이스 저장 없이 이메일로 즉시 전송

### 6.2 데이터 흐름

```
사용자 입력 → Astro API → Resend → newbom@newbom.co.kr
(이메일, 제품정보)   (검증)    (발송)      (수신)
```

| 데이터 유형      | 저장 위치                  | 보존 기간 |
| ---------------- | -------------------------- | --------- |
| 이메일, 제품정보 | 저장 안 함 (이메일 전송만) | -         |
| 방문 로그        | Vercel Analytics           | 30일      |

---

## 7. 테스트 전략

### 7.1 테스트 피라미드

| 레벨 | 도구       | 커버리지 목표      | 위치           |
| ---- | ---------- | ------------------ | -------------- |
| Unit | Vitest     | 핵심 유틸리티 함수 | src/**tests**/ |
| E2E  | Playwright | 핵심 사용자 흐름   | e2e/           |

### 7.2 핵심 테스트 시나리오

**E2E 필수 시나리오:**

1. 랜딩 페이지 로드 및 CTA 클릭
2. 라벨링 서비스 4단계 완료
3. 이메일 입력 및 제출
4. 견적 문의 버튼 동작

### 7.3 품질 게이트

**배포 전 필수:**

- [ ] Lighthouse 점수 ≥ 90
- [ ] E2E 테스트 통과
- [ ] 린트/타입 체크 통과
- [ ] 빌드 성공

---

## 8. API 설계

### 8.1 이메일 발송 API

**POST /api/send-lead**

Request:

```json
{
  "email": "user@example.com",
  "productName": "Spicy Instant Noodle",
  "targetMarket": "EU",
  "ingredients": [...],
  "nutrition": {...},
  "labelOutput": "..."
}
```

Response (성공):

```json
{
  "success": true,
  "message": "이메일이 전송되었습니다."
}
```

Response (실패):

```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "유효한 이메일을 입력하세요."
  }
}
```

---

## 9. 프로젝트 구조

```
newbom-homepage/
├── src/
│   ├── components/          # 재사용 컴포넌트
│   │   ├── common/          # 공통 (Button, Card 등)
│   │   ├── landing/         # 랜딩 페이지 섹션
│   │   └── label-ai/        # 라벨링 서비스 (React)
│   │       ├── Step1.tsx
│   │       ├── Step2.tsx
│   │       ├── Step3.tsx
│   │       ├── Step4.tsx
│   │       └── LabelAI.tsx  # 메인 컨테이너
│   │
│   ├── layouts/
│   │   └── Layout.astro     # 기본 레이아웃
│   │
│   ├── pages/
│   │   ├── index.astro      # 랜딩 페이지
│   │   ├── label.astro      # 라벨링 서비스 페이지
│   │   └── api/
│   │       └── send-lead.ts # 이메일 발송 API
│   │
│   ├── styles/
│   │   └── global.css       # 글로벌 스타일
│   │
│   └── lib/
│       ├── utils.ts         # 유틸리티 함수
│       └── constants.ts     # 상수 (알러지 목록 등)
│
├── public/
│   ├── favicon.ico
│   └── images/
│
├── e2e/
│   └── landing.spec.ts      # E2E 테스트
│
├── docs/
│   └── planning/            # 기획 문서
│
├── astro.config.mjs
├── tailwind.config.mjs
├── tsconfig.json
├── package.json
└── README.md
```

---

## 10. 배포 전략

### 10.1 브랜치 전략

| 브랜치     | 용도      | 배포 환경         |
| ---------- | --------- | ----------------- |
| main       | 프로덕션  | Vercel Production |
| develop    | 개발      | Vercel Preview    |
| feature/\* | 기능 개발 | Vercel Preview    |

### 10.2 배포 흐름

```
feature/* → PR → develop → PR → main
              ↓            ↓
          Preview       Production
```

### 10.3 환경 변수

| 변수명               | 환경       | 설명              |
| -------------------- | ---------- | ----------------- |
| RESEND_API_KEY       | Production | Resend API 키     |
| PUBLIC_KAKAO_CHANNEL | All        | 카카오톡 채널 URL |

---

## Decision Log

- 2026-02-02: Astro 선택 (Next.js 대신) - 정적 사이트 최적화, 간단한 구조
- 2026-02-02: Resend 선택 (SendGrid 대신) - 개발자 친화적, 간단한 API
- 2026-02-02: 데이터베이스 없음 - 이메일 전송만으로 충분
- 2026-02-02: Vercel 호스팅 - Astro 최적화, 무료 티어 충분
